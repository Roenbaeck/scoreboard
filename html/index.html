<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="Cache-Control" content="no-cache">
    <link rel="stylesheet" href="scoreboard.css">
    <script type="text/javascript">
        const DOM_PARSER = new DOMParser();
        var current_scoreboard_xml;
        window.addEventListener('load', function() {
            // Set theme from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const theme = urlParams.get('theme') || 'default';
            document.body.className = `theme-${theme}`;

            setInterval(() => {
                fetch('scoreboard.xml?' + (new Date()).getTime())
                    .then((response) => {
                        return response.text();
                    })
                    .then((scoreboard_xml) => {
                        if(scoreboard_xml == current_scoreboard_xml) {
                            return;
                        }    
                        else {
                            current_scoreboard_xml = scoreboard_xml;
                            var parsed_xml = DOM_PARSER.parseFromString(scoreboard_xml, 'text/xml');
                            for (const elementName of ['scoreboard', 'lineup', 'highlight']) {
                                const element = parsed_xml.getElementById(elementName);
                                const target = document.getElementById(elementName + '_wrapper');
                                if (element) {
                                    target.replaceChildren(element);
                                } else {
                                    target.replaceChildren();
                                }
                            }
                        }
                    })
            }, 1000);
        });
    </script>    
</head>
<body>
    <div id="content_wrapper" class="content_wrapper">
        <div id="scoreboard_wrapper" class="scoreboard_wrapper"></div>
        <div id="lineup_wrapper" class="lineup_wrapper"></div>
        <div id="highlight_wrapper" class="highlight_wrapper"></div>
    </div>
</body>
</html>
